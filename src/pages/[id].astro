---
import supabase from "../components/SupabaseClient";
import Layout from "../layouts/Layout.astro";
import fs from "fs";
import Markdown from '@astrojs/markdown-component';

export function getStaticPaths() {
  return [{ params: { id: "pawpaw" } }, { params: { id: "terms" } }];
}

const { id } = Astro.params;

if (!id) {
  return Astro.redirect("/404");
}

const { data, error } = await supabase.storage
  .from("astro-markdown")
  .download(id + ".md");

if (error) {
  return Astro.redirect("/404");
}

const blob = data;
const buffer = Buffer.from(await blob.arrayBuffer()).toString();

const file = fs.writeFile('/tmp/' + id + ".md", buffer.toString(), function (err: any) {
if (err) {
return console.log(err);
}
});

const content = fs.readFileSync('/tmp/'+ id + ".md", "utf8");
console.log(content);

const item = content;
---

<Markdown content={item}></Markdown>